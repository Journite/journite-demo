import { AnimatePresence, motion } from "framer-motion";
import { useEffect, useState } from "react";
import { useAppSelector } from "../../../store";

export default function LoadingOverlay() {
  const goalLoading = useAppSelector((state) => state.goals.loading);
  const goalUpdating = useAppSelector((state) => state.goals.updating);
  const registerLoading = useAppSelector((state) => state.register.loading);
  const authLoading = useAppSelector((state) => state.auth.loading);
  const credentialHasBeenFetched = useAppSelector(
    (state) => state.auth.credentialHasBeenFetched,
  );

  const isShow = goalLoading || goalUpdating || registerLoading || authLoading;
  const [show, setShow] = useState(false);

  useEffect(() => {
    let timeOut: NodeJS.Timeout;
    if (isShow) setShow(true);
    else timeOut = setTimeout(() => setShow(false), 1000);
    return () => {
      if (!isShow) window.clearTimeout(timeOut);
    };
  }, [isShow]);

  return (
    <>
      <div className={show ? "" : "hidden"}>
        <AnimatePresence>
          {isShow && (
            <motion.span
              initial={{ opacity: 0 }}
              animate={{
                opacity: 1,
              }}
              exit={{ opacity: 0 }}
              transition={{ duration: 0.5 }}
              className="fixed bottom-0 left-0 right-0 top-0 z-[1000000000] flex items-center justify-center bg-foreground/50 backdrop-blur-sm"
            >
              <div className="loader relative flex h-[224px] w-[224px] bg-white"></div>
              <div className="logo absolute">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 186.50124 32.15918"
                  width={160}
                  className="logo mt-1 from-black"
                >
                  <g id="Layer_2" data-name="Layer 2">
                    <g id="Layer_1-2" data-name="Layer 1">
                      <path d="M27.2471,13.29492a.201.201,0,0,1-.14063.24707,102.6578,102.6578,0,0,0-16.62695,5.68018q-1.09571.51708-2.07178,1.04883c-.76367,4.71289-1.95849,8.82421-3.74755,10.73144a3.22592,3.22592,0,0,1-2.36866,1.15674,2.05019,2.05019,0,0,1-1.83642-.999,4.76091,4.76091,0,0,1,.15527-4.35108,15.57783,15.57783,0,0,1,5.897-5.89209q.271-2.05884.46729-4.48681A142.05941,142.05941,0,0,0,7.31253.40137H5.68606a.20069.20069,0,1,1,0-.40137H10.8638a.20069.20069,0,0,1,0,.40137H9.47073a104.58327,104.58327,0,0,1-.98388,19.37109q.86644-.46288,1.82128-.91357A102.97592,102.97592,0,0,1,27.001,13.1543.19958.19958,0,0,1,27.2471,13.29492ZM3.48294,30.85889c1.27051-1.33545,2.27393-4.55518,2.95361-9.4209A14.88613,14.88613,0,0,0,.96878,26.99072a5.30947,5.30947,0,0,0-.561,2.18457A3.035,3.035,0,0,0,1.00882,31.082a1.35662,1.35662,0,0,0,1.063.47266A1.925,1.925,0,0,0,3.48294,30.85889Z" />
                      <path d="M49.30374,13.499A27.3704,27.3704,0,0,1,42.229,17.99268a16.06971,16.06971,0,0,1-7.67773,1.47265,9.49867,9.49867,0,0,1-2.40186-.53076q-.06151.15894-.13037.30664l-.01025.022-.00391.0083a3.31063,3.31063,0,0,1-.62109.90284,2.672,2.672,0,0,1-1.97363.78369,2.76208,2.76208,0,0,1-2.42041-1.48145,6.98888,6.98888,0,0,1-.14454-6.19922.60982.60982,0,0,1,.59424-.24218c.00733-.04737.01612-.09424.02686-.14014l.00049-.00586.00293-.01611c.00341-.01514.00634-.02979.01074-.04492.00537-.02344.01123-.04688.01709-.07032l.01416-.05176a2.51355,2.51355,0,0,1,.16211-.43261,1.73939,1.73939,0,0,1,1.58593-1.05323,2.86042,2.86042,0,0,1,2.36426,1.36866,6.316,6.316,0,0,1,.94971,3.498,8.42875,8.42875,0,0,1-.2959,2.46631,9.1378,9.1378,0,0,0,2.311.5127c5.14257.48242,10.83642-2.71582,14.45068-5.86963a.20089.20089,0,1,1,.26416.30273ZM31.7764,18.78809a8.606,8.606,0,0,1-3.45948-2.67579c-.08935-.11376-.17187-.22949-.24707-.34521a5.54877,5.54877,0,0,0,.18946,3.86279,1.44128,1.44128,0,0,0,1.30029.74073,2.1199,2.1199,0,0,0,2.09424-1.29493l.00439-.00732Q31.72122,18.9336,31.7764,18.78809Zm-1.166-6.04a2.0963,2.0963,0,0,0-1.55566-.917,1.146,1.146,0,0,0-1.12451.88282.33634.33634,0,0,0-.01221.03759,2.56141,2.56141,0,0,0-.07813.33838,2.43349,2.43349,0,0,1,.54.19483c.51709.27148.41309.57129.36817.65674a8.12425,8.12425,0,0,0-.52686,1.28613,4.0922,4.0922,0,0,0,.41162.63672A8.22408,8.22408,0,0,0,31.88577,18.397,7.93479,7.93479,0,0,0,30.61038,12.748Z" />
                      <path d="M74.85062,13.49561c-.08692.07959-.18848.17431-.30323.28125a36.34023,36.34023,0,0,1-6.73926,5.13623.177.177,0,0,1-.04052.02685l-.09131.04688A13.93533,13.93533,0,0,1,61.10208,20.958a5.42418,5.42418,0,0,1-4.7627-2.30908,7.91269,7.91269,0,0,1-1.249-4.09571,23.77617,23.77617,0,0,1-1.06982,2.95557c-1.02491,2.27881-2.16944,3.43408-3.40235,3.43408a1.74781,1.74781,0,0,1-1.438-.727c-1.29346-1.6748-.94776-5.97656-.29-8.49512.13183-.50537,1.22265-.6206,1.6455-.5122.38819.09912.3418.36816.32862.42041-.63526,2.53027-1.4458,7.15039-.45508,8.42041a.7028.7028,0,0,0,.58252.29345c.99805,0,1.99316-1.72265,2.33105-2.312a23.92779,23.92779,0,0,0,1.87207-5.46484,6.27758,6.27758,0,0,1,.30811-1.21631c.16846-.44238,1.07373-.5127,1.481-.38135.32812.10547.395.32959.34814.5044-.47852,1.79052-.873,5.36181.68457,7.38964a4.09747,4.09747,0,0,0,3.45215,1.502,13.14026,13.14026,0,0,0,5.9209-1.68213c.04687-.02344.09033-.0459.13037-.0669a35.79139,35.79139,0,0,0,6.75342-5.13281c.11621-.10742.21777-.20215.30566-.28271a.20079.20079,0,0,1,.27149.2959Z" />
                      <path d="M97.45364,13.49561c-.08691.07959-.188.17431-.30273.28125a36.32379,36.32379,0,0,1-6.73926,5.13623.19164.19164,0,0,1-.041.02685c-.02783.01465-.05859.03027-.09082.04688a13.93389,13.93389,0,0,1-6.5747,1.97119,5.42386,5.42386,0,0,1-4.76221-2.30908,8.945,8.945,0,0,1-1.01025-6.74219c-.07276.064-.14942.13183-.22754.20215a4.57758,4.57758,0,0,1-2.81592,1.50244,2.25685,2.25685,0,0,1-.55566-.06885,1.41789,1.41789,0,0,1-1.02295-1.62842l.00048-.0122a2.60241,2.60241,0,0,1,.05176-.37842l.002-.01123c.23584-1.16211,1.13818-2.36573,2.12646-2.36573a1.04892,1.04892,0,0,1,.96094.59913,3.37966,3.37966,0,0,1-.30615,2.89111,10.32838,10.32838,0,0,0,1.34375-.93945,5.74045,5.74045,0,0,1,.92822-.64893l.0039-.00195.01807-.00733.0083-.00293.00244-.00049a1.8588,1.8588,0,0,1,1.13672-.06738c.32813.10547.395.32959.34815.5044-.47852,1.79052-.87305,5.36132.68408,7.38964a4.099,4.099,0,0,0,3.45263,1.502,13.14956,13.14956,0,0,0,5.9209-1.68164c.04688-.02393.08985-.04639.12989-.06739a35.78838,35.78838,0,0,0,6.75439-5.13281c.11572-.10742.21729-.20215.30518-.28271a.20062.20062,0,1,1,.271.2959Zm-21.94433-.57422a3.285,3.285,0,0,0,.58642-2.98926.64756.64756,0,0,0-.60449-.38379c-.771,0-1.5332,1.07422-1.7334,2.04639v.00195l-.0039.02148c-.00879.04-.01514.07959-.021.11914l-.00781.05616c-.00537.04052-.00977.08105-.01221.1206l-.001.01172-.00244.05225a1.164,1.164,0,0,0,.16113.67676.85894.85894,0,0,0,.58008.35888A2.06746,2.06746,0,0,0,75.50931,12.92139Z" />
                      <path d="M124.82815,13.50391a53.06529,53.06529,0,0,1-6.26562,4.4331q-1.53223.91407-2.94336,1.57813l-.10156.04882c-.2002.09278-.39649.18165-.5918.26758-.05859.02491-.11719.0503-.17773.0752a14.69065,14.69065,0,0,1-5.6543,1.36523c-1.93945,0-3.209-.70947-3.88232-2.16894a10.945,10.945,0,0,1-.646-4.17432c-.04981-1.92041-.12988-3.09766-1.08692-3.09766-.9165,0-1.52,1.76319-1.74707,2.42627l-.00048.00147c-.24317.78271-.44873,1.6543-.64551,2.48682-.53272,2.26074-.99365,4.2124-2.07764,4.2124a1.43055,1.43055,0,0,1-1.14013-.66113c-1.11329-1.47168-1.40381-5.08106-.86084-7.00342.13134-.46289,1.0288-.52393,1.45312-.42578.50293.11718.48828.42431.47119.51611-.49707,2.73-.729,6.03223-.06055,6.832a.37082.37082,0,0,0,.29834.15479c.52686,0,.96338-1.53174,1.12745-2.10791l.022-.07715c.13037-.48877.25342-1.0127.376-1.53223.2041-.86475.41064-1.73926.65429-2.52637.50977-1.644,1.18555-2.90674,2.35156-2.90674l.01514.00147.01563-.00147c2.11572,0,2.26806,2.20606,2.415,4.33838.17334,2.51709.353,5.11963,3.31494,5.11963a13.07358,13.07358,0,0,0,4.69531-.96533l.02344-.00928a44.99165,44.99165,0,0,0,10.39453-6.51123.20095.20095,0,0,1,.2539.31153Z" />
                      <path d="M144.73636,13.49561a38.99067,38.99067,0,0,1-7.48047,5.34912.2446.2446,0,0,1-.02637.01709l-.01074.00488c-.02539.01318-.05078.02588-.07617.03857a15.67664,15.67664,0,0,1-7,2.05274,5.42817,5.42817,0,0,1-4.76367-2.30908,8.91242,8.91242,0,0,1-.83594-7.29932c.168-.44238,1.07422-.5127,1.48144-.38135.32715.10547.39453.32959.34864.5044-.47852,1.79052-.87305,5.36132.68359,7.38964a4.09808,4.09808,0,0,0,3.45215,1.502,14.90889,14.90889,0,0,0,6.52832-1.856l.01172-.00537.01953-.00879a38.66969,38.66969,0,0,0,7.39648-5.29443.20079.20079,0,1,1,.27149.2959ZM124.54886,9.1167a1.05957,1.05957,0,1,1,1.05957,1.05957A1.06017,1.06017,0,0,1,124.54886,9.1167Z" />
                      <path d="M164.03909,13.49561c-.08691.07959-.1875.17431-.30273.28125a36.35708,36.35708,0,0,1-6.74024,5.13671.21052.21052,0,0,1-.03906.02637c-.0293.01416-.05957.03027-.0918.04688l-.00879.00439A13.92882,13.92882,0,0,1,150.291,20.958a5.39513,5.39513,0,0,1-4.08984-1.58447c-1.47363-1.5503-2.126-4.2251-1.9375-7.9502v-.01465a26.05613,26.05613,0,0,1,1.01172-5.7207c-1.25586.05762-2.41992.0874-3.39355.0874-.2295,0-.44629-.00195-.65333-.00537-2.1875-.03516-2.377-.23682-2.46777-.333a.25908.25908,0,0,1-.0459-.30762c.042-.07617.1377-.25341,1.10645-.36474a5.5981,5.5981,0,0,1,1.37109-.01319.20077.20077,0,1,1-.06933.39551,5.94274,5.94274,0,0,0-1.78809.10254,37.5442,37.5442,0,0,0,6.06738.03076c.96289-3.00341,2.42578-5.27539,4.05469-5.27539a1.13411,1.13411,0,0,1,1.02246.52149,3.81306,3.81306,0,0,1,.124,2.59424l-.00292.01416c-.02442.14453-.05176.27587-.07911.38769l-.00683.01953c-.10059.44239-.22949.917-.38379,1.417a80.04867,80.04867,0,0,0,8.06348-1.06591.20109.20109,0,0,1,.07812.39453A81.10036,81.10036,0,0,1,150,5.374a77.91763,77.91763,0,0,1-3.29688,7.97559c-.27148.58643-.48632,1.05029-.60156,1.32715l-.00976.0166a7.39611,7.39611,0,0,0,1.6289,4.55762,3.9535,3.9535,0,0,0,2.93653,1.11328,13.14538,13.14538,0,0,0,5.92089-1.68164c.04493-.02246.08594-.04395.125-.064a35.82943,35.82943,0,0,0,6.75977-5.13623c.11523-.10742.2168-.20215.30469-.28271a.20079.20079,0,0,1,.27148.2959Zm-17.998.33056c.0879-.19238.1875-.40869.29688-.645.75391-1.62793,2.0127-4.35254,2.91309-6.852q.17431-.48559.31738-.91894c-.9043.0747-1.82227.14111-2.74414.19531a29.255,29.255,0,0,0-.78906,5.812v.00391c0,.17138-.002.36474-.00489.57617C146.02347,12.51123,146.01565,13.14209,146.041,13.82617Zm.8877-8.6289c.93164-.05713,1.86035-.12452,2.77246-.20069a17.77215,17.77215,0,0,0,.50781-1.958l.002-.01171a3.37241,3.37241,0,0,0-.16211-2.17872.45733.45733,0,0,0-.38477-.18359C148.668.66455,147.6387,2.52344,146.92874,5.19727Z" />
                      <path d="M186.4219,13.50781a47.38492,47.38492,0,0,1-9.74414,5.82471c-.043.01758-.08789.03711-.13867.05713-.0332.01318-.06836.02832-.10351.043-.08106.03271-.16993.06836-.26563.106a17.69216,17.69216,0,0,1-6.38476,1.40821,10.6264,10.6264,0,0,1-1.10645-.05615,6.73227,6.73227,0,0,1-4.43164-1.98292,4.7763,4.7763,0,0,1-1.18652-3.45849,5.08214,5.08214,0,0,1,1.10546-2.92676,3.36246,3.36246,0,0,1,2.59375-1.30225,1.72775,1.72775,0,0,1,1.57032.72657,2.0352,2.0352,0,0,1,.0039,1.94922l-.0039.00927a5.57131,5.57131,0,0,1-3.33594,2.64307,4.95408,4.95408,0,0,0,4.60937,3.80469,16.1426,16.1426,0,0,0,6.916-1.38916l.00195.00293a47.07811,47.07811,0,0,0,9.65723-5.77881.20088.20088,0,1,1,.24316.31982Zm-21.51757,2.646a5.14822,5.14822,0,0,0,3.05859-2.41358l.001-.00146a1.57875,1.57875,0,0,0-.05371-1.46924,1.07,1.07,0,0,0-.92188-.45654c-1.44141,0-2.13574,1.53076-2.18555,3.04834A5.92651,5.92651,0,0,0,164.90433,16.15381Z" />
                    </g>
                  </g>
                </svg>
              </div>
            </motion.span>
          )}
        </AnimatePresence>
      </div>
    </>
  );
}
